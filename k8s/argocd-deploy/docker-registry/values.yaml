persistence:
  class: smb
  # generated by SMB storage CSI controller
  #
  # if reclaiming remember to do this if pvc is stuck in PENDING
  # https://github.com/kubernetes-csi/csi-driver-smb/issues/821
  volumeName: pvc-888a27fe-bdbe-4c7c-88b3-9014ac93391a
  size: 128Gi

docker-registry-ui:
  registry:
    enabled: true
    dataVolume:
      persistentVolumeClaim:
        claimName: docker-registry-pvc
    ingress:
      tls:
        - hosts:
          - docker.rannet.duckdns.org
          secretName: docker-registry-cert
      enabled: true
      host: docker.rannet.duckdns.org
      annotations:
        cert-manager.io/cluster-issuer: duckdns-letsencrypt-prod
        nginx.ingress.kubernetes.io/proxy-body-size: "0"
        nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
        nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
  ui:
    ingress:
        enabled: true
        tls:
          - hosts:
            - docker-registry.rannet.duckdns.org
            secretName: docker-registry-ui-cert
        # automatically has a prefix of /v2
        host: docker-registry.rannet.duckdns.org
        annotations:
          cert-manager.io/cluster-issuer: duckdns-letsencrypt-prod
          nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
          nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
          nginx.ingress.kubernetes.io/ssl-passthrough: "true"
          # nginx.ingress.kubernetes.io/auth-url: https://oauth2-proxy.home.k8s:30443/oauth2/auth
          # # don't feel too good about this; ideally should be $server_port, but
          # # using a NodePort instead of an actual LB doesn't seem to allow this (TBD)
          # nginx.ingress.kubernetes.io/auth-signin: "https://oauth2-proxy.home.k8s:30443/oauth2/start?rd=$scheme://$host:30443$request_uri"
          # nginx.ingress.kubernetes.io/auth-response-headers: X-Auth-Request-User,X-Auth-Request-Email,X-Forwarded-Groups
